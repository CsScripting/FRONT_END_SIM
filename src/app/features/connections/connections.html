<div class="content-header">
  <div class="header-left-content">
    <h1>Connections</h1>
  </div>
</div>

<div class="admin-container" *ngIf="selectedClientName && selectedTypeName; else prompt">
  <header class="admin-header">
    <h2>Active connections for {{ selectedClientName }} / {{ selectedTypeName }}</h2>
    <p *ngIf="selectedEnvironment && credentials().length > 0">
      The following {{ credentials().length }} connection{{ credentials().length !== 1 ? 's' : '' }} will be activated:
    </p>
    <p *ngIf="!selectedEnvironment || credentials().length === 0" class="warning-text">
      No connections available for this environment. Please configure credentials first.
    </p>
  </header>

  <form [formGroup]="selectionForm" (ngSubmit)="onSubmit()" *ngIf="selectedEnvironment && credentials().length > 0">
    <main class="content-grid" formArrayName="selectedConnections">
      <div 
        class="content-card credential-card selected" 
        *ngFor="let cred of credentials(); let i = index">
        
        <div class="card-icon">
          <i class="fas fa-plug"></i>
        </div>
        <div class="card-content">
          <h2 class="credential-name">{{ cred.name }}</h2>
          <p class="credential-type">Type: {{ cred.credential_type_name }}</p>
          <p class="credential-environment">Environment: {{ selectedEnvironment.name }}</p>
        </div>
        <div class="selection-indicator">
          <input type="checkbox" [formControlName]="i">
          <span class="selected-label">Selected</span>
        </div>
      </div>
    </main>

    <footer class="admin-footer">
      <button type="button" class="btn-cancel" (click)="onCancel()">Cancel</button>
      <button type="submit" class="btn-save">Save Selection</button>
    </footer>
  </form>

  <div class="no-credentials-message" *ngIf="!selectedEnvironment || credentials().length === 0">
    <i class="fas fa-exclamation-circle"></i>
    <p>No connections configured for this environment.</p>
    <small>Contact your administrator to configure credentials.</small>
  </div>
</div>

<ng-template #prompt>
  <div class="no-content prompt">
    <i class="fas fa-info-circle"></i>
    <p>Incomplete Selection</p>
    <span *ngIf="!selectedClientName">Please start by <a routerLink="/clients">selecting a client</a>.</span>
    <span *ngIf="selectedClientName && !selectedTypeName">Please continue by <a routerLink="/environments-admin">selecting an environment type</a>.</span>
  </div>
</ng-template>
